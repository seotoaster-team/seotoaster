function toggleOptimized(a){$("#optimized").val(a);$.post($("#website_url").val()+"backend/backend_page/toggleoptimized/",{pid:$("#pageId").val(),optimized:a,secureToken:$("#frm-page").find(".secureToken").val()},function(c){$.each(c.data,function(c,b){var e=$("[name="+c+"]",$("#frm-page"));e.val(b);a?e.attr("disabled",!0).attr("readonly","readonly").addClass("noedit"):e.removeAttr("disabled").removeAttr("readonly").removeClass("noedit")})},"json")}
function toggleExternalLink(){var a=$("#external-link-status"),c="h1 header-title meta-keywords meta-description page-options curr-template".split(" "),d=$("#external-link-switch").prop("checked")?1:0;a.length&&(a.val(d),$("#toggle-optimized").is(":checked")||($.each(c,function(b,a){$("#"+a).prop("readonly",d).toggleClass("noedit")}),d?($(".template-section").css({visibility:"hidden"}),$("#url").val($("#external-link").val()),""===$.trim($("#url").val())&&$("#url").prop("placeholder","Your link to an external website")):
($("#url").val($("#original-page-url").val()),$(".template-section").css({visibility:"visible"}),$("#url").prop("placeholder",""))))}function datepickerCallback(){$("#publish-at").val($(this).val())}
function checkMenu(a,c){var d=$("#pageId").val(),b=$("#pageCategory");void 0!==a&&a||(a=$(".menu-selector:checked").attr("id"));switch(a){case "inMenu-2":$(".menu-info").show().text("This page is in flat menu");case "inMenu-0":b.find('option[value="-1"]').length||b.prepend($("<option />").val("-1").text("No category"));b.val(-1);b.hide();"inMenu-0"===a&&$(".menu-info").show().text("This page is not in menu");break;case "inMenu-1":b.find('option[value="-1"]').remove(),d?void 0!==c&&b.val(c):b.val(-4),
b.show().next(".menu-info").hide()}}$(document).on("change","#template-categories",function(){var a=$(this).val();$(".template_group").hide();$("#"+a).show()});function showTemplatesList(){var a=$("#templatelist");$.post($("#website_url").val()+"backend/backend_theme/gettemplate/pageId/"+$("#pageId").val(),{listtemplates:"all",beforeSend:showSpinner("#templatelist")},function(c){a.html(c);hideSpinner()})}
$(function(){$("#pageCategory").hide();var a=[$("#header-title"),$("#url"),$("#nav-name")],c=!$("#pageId").val(),d=$("#pageCategory").val();$("#optimized").val($("#toggle-optimized").attr("checked")?1:0);1!=$("#external-link-status").val()||$("#toggle-optimized").attr("checked")||toggleExternalLink();$(document).on("click",".template_name",function(){var b=$(this).parent().find('input[name="template-id"]').val();$("#templateId").val(b).change();$("#curr-template").text(b);$("#templatelist").hide("slide",
{direction:"right"})}).on("click","input.menu-selector",function(b){checkMenu($(b.currentTarget).attr("id"),d)}).on("click","#toggle-optimized",function(){var b=$(this),a=b.is(":checked")?1:0;a?toggleOptimized(a):showConfirm("Are you sure? You will lose expert optimization once you save your changes !",function(){toggleOptimized(a)},function(){b.prop("checked",!0)})}).on("click","#published",function(){var a=$("#draft");a.length&&a.val($(this).prop("checked")?0:1)}).on("blur","#datepicker",function(){$("#publish-at").val($(this).val())}).on("change",
"#external-link-switch",function(){toggleExternalLink()});c&&$("#h1").keyup(function(){var b=$(this).val();$(a).each(function(){$(this).val(b);$(this).removeClass("notvalid").removeAttr("title")})});checkMenu()});
