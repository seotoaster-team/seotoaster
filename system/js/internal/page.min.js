$(function(){$("#pageCategory").hide();var a=[$("#header-title"),$("#url"),$("#nav-name")],d=$("input.menu-selector"),e=!$("#pageId").val(),c=$("#pageCategory").val();$("#optimized").val($("#toggle-optimized").attr("checked")?1:0);$(document).on("click",".template_name",function(){var b=$(this).parent().find('input[name="template-id"]').val();$("#templateId").val(b).change();$("#curr-template").text(b);$("#templatelist").hide("slide",{direction:"right"})}).on("click","input.menu-selector",function(b){checkMenu($(b.currentTarget).attr("id"),
c)}).on("click","#toggle-optimized",function(){var b=$(this),a=b.is(":checked")?1:0;a?toggleOptimized(a):showConfirm("Are you sure? You will lose experts optimization once you save your changes !",function(){toggleOptimized(a)},function(){b.prop("checked",!0)})}).on("click","#published",function(){var a=$("#draft");a.length&&a.val($(this).prop("checked")?0:1)}).on("blur","#datepicker",function(){$("#publish-at").val($(this).val())});e?($("#h1").keyup(function(){var b=$(this).val();$(a).each(function(){$(this).val(b);
$(this).removeClass("notvalid").removeAttr("title")})}),d.each(function(){$(this).attr("checked",!1)})):checkMenu()});
function toggleOptimized(a){$("#optimized").val(a);$.post($("#website_url").val()+"backend/backend_page/toggleoptimized/",{pid:$("#pageId").val(),optimized:a},function(d){$.each(d.data,function(d,c){var b=$("[name="+d+"]",$("#frm-page"));b.val(c);a?b.attr("disabled",!0).attr("readonly","readonly").addClass("noedit"):b.removeAttr("disabled").removeAttr("readonly").removeClass("noedit")})},"json")}function datepickerCallback(){$("#publish-at").val($(this).val())}
function checkMenu(a,d){var e=$("#pageId").val(),c=$("#pageCategory");$("#website_url").val();"undefined"!=typeof a&&a||(a=$(".menu-selector:checked").attr("id"));switch(a){case "inMenu-2":$(".menu-info").show().text("This page is in flat menu");case "inMenu-0":c.find('option[value="-1"]').length||c.prepend($("<option />").val("-1").text("No category"));c.val(-1);c.hide();"inMenu-0"==a&&$(".menu-info").show().text("This page is not in menu");break;case "inMenu-1":c.find('option[value="-1"]').remove(),
e?"undefined"!=typeof d&&c.val(d):c.val(-4),c.show().next(".menu-info").hide()}}
function showTemplatesList(){$.post($("#website_url").val()+"backend/backend_theme/gettemplate/pageId/"+$("#pageId").val(),{listtemplates:"all",beforeSend:showSpinner("#templatelist")},function(a){$("#templatelist").html(a).find(".content").accordion({heightStyle:"content",header:".template_header",collapsible:!0,icons:{header:"icon-arrow-right",activeHeader:"icon-arrow-down"}});$("#templatelist .template_group").css({"max-height":$("#templatelist .content").height()-($("#templatelist .template_header").outerHeight(!0)+
2)*$("#templatelist .template_header").length});hideSpinner()})};
