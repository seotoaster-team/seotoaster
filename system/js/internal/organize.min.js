$(function(){$("#mass-del").click(function(){var a=[];$(".page-remove:checked").each(function(){a.push($(this).closest("li").attr("id"))});a.length?showConfirm("You are about to remove one or many pages. Are you sure?",function(){$.ajax({url:$("#website_url").val()+"backend/backend_page/delete/",type:"post",data:{id:a},dataType:"json",beforeSend:function(){showSpinner()},success:function(b){hideSpinner();showMessage(b.responseText);$(a).each(function(){$("#"+this).remove()})}})}):showMessage("Select at least one item please",
!0)});$("#sortable-main").sortable({handle:".catmove",cancel:".nosort",helper:"clone",stop:saveCategoriesOrder});$(".move").each(function(){$(this).click(function(a){a.ctrlKey&&($(this).toggleClass("selected"),$(this).find("input[type='checkbox']").prop("checked")?$(this).find("input[type='checkbox']").prop("checked",!1):$(this).find("input[type='checkbox']").prop("checked",!0))})});$(".organise").on("click",".page-remove",function(a){a.stopImmediatePropagation();$(this).closest(".move").toggleClass("selected")});
$(".organise").each(function(){$(this).sortable({connectWith:".organise",placeholder:"placeholder",start:function(a,b){b.item.siblings(".selected").appendTo(b.item)},receive:function(a,b){var c=[];$(this).find("li").each(function(){c.push($(this).attr("id"))});renewedData={act:"renew",menu:$(this).parent().data("menu"),categoryId:$(this).parent().attr("id"),pages:c};$.post($("#website_url").val()+"backend/backend_page/organize/",renewedData)},stop:function(a,b){var c=b.item.find(".selected");b.item.after(c);
saveCategoriesOrder()}})});$(".collapse-all").click(function(){$(this).parent().next().slideToggle();$(this).toggleClass("ticon-arrow-up ticon-arrow-down")});$("#collapse-global").click(function(){$(".organise").slideUp();$(".collapse-all").removeClass("ticon-arrow-up").addClass("ticon-arrow-down")});$("#expand-global").click(function(){$(".organise").slideDown();$(".collapse-all").removeClass("ticon-arrow-down").addClass("ticon-arrow-up")});$(".check-all").click(function(){$(this).closest(".catmove").next().find("input:checkbox").prop("checked",
$(this).prop("checked"))})});
function saveCategoriesOrder(){var a=0,b=[];$("#sortable-main").find(".category-data").each(function(){$(this).find(".ranking").html("#"+ ++a);b.push($(this).attr("id"));$(this).find(".organise li").each(function(){b.push($(this).attr("id"))})});$.ajax({type:"post",url:$("#website_url").val()+"backend/backend_page/organize/",data:{act:"save",ordered:b},dataType:"json",beforeSend:function(){showSpinner()},success:function(a){hideSpinner();showMessage(a.responseText,a.error)}})}
function removeMarks(a){"undefined"!==a&&(1<a.length?$.each(a,function(a,c){$(c).removeClass("selected");$(c).find("input[type='checkbox']").attr("checked",!1)}):($(a).removeClass("selected"),$(a).find("input[type='checkbox']").attr("checked",!1)))};
