$(function(){$("#tabs").tabs();$("#tabs ul").removeClass("ui-corner-all").addClass("ui-corner-top");$(document).one("click",'a[href="#tabs-frag-2"]',function(){$("#tabs-frag-2").empty().load($("#website_url").val()+"backend/backend_content/loadwidgetmaker/")});$(document).on("click","a.ui-tabs-anchor",function(){$(this).find("#products, #news").length?($(".above-editor-links").removeClass("grid_8").addClass("grid_4"),$("#tabs").removeClass("grid_4").addClass("grid_8"),$(".mce-toolbar-grp").hide()):
($(".mce-toolbar-grp").show(),$(".above-editor-links").removeClass("grid_4").addClass("grid_8"),$("#tabs").removeClass("grid_8").addClass("grid_4"))});$(document).on("click",'[aria-label="Fullscreen"]',function(){$(window.parent.document).find('[aria-describedby="toasterPopupDraggable"]').toggleClass("screen-expand");var a=$("#tabs"),b=a.height(),c=a.find(".ui-tabs-nav").height(),d=a.find("#adminthingsviewer .ui-accordion-header"),e=d.length,d=d.outerHeight(),f=a.find("#adminselectimgfolder").outerHeight(),
g=a.find("#btn-create").outerHeight(),h=a.find("#widgetSync").outerHeight()+5;a.find("#adminthingsviewer .ui-accordion-content").css({"max-height":b-c-(d+2)*e-f-30});a.find("#product-products").css({height:b-c-g-116});a.find(".netcontent-widget-list").css({height:b-c-h-12})});$("#btn-submit").click(function(){$("#frm_content").submit()});$("#frm_content").submit(function(){var a={content:$(this).find("#content").val(),containerType:$(this).find("#container_type").val(),containerName:$(this).find("#container_name").val(),
pageId:$(this).find("#page_id").val(),containerId:$(this).find("#container_id").val(),published:$("#published").prop("checked")?1:0,publishOn:$("#datepicker").val(),secureToken:$(this).find(".secureToken").val()};$.ajax({url:$(this).attr("action"),type:"post",dataType:"json",data:a,beforeSend:showSpinner(),success:function(){localStorage.removeItem(generateStorageKey());top.location.reload()},error:function(a){showMessage(a.responseText,!0)}});return!1});$("#nolink").change(function(){$(this).is(":checked")?
$("#nolink").val(1):$("#nolink").val(0);$("#adminselectimgfolder").trigger("change")});$("#adminselectimgfolder").change(function(){var a=$(this).val(),b=$("#nolink").val();a&&0!=a&&$.ajax({url:$("#website_url").val()+"backend/backend_content/loadimages",type:"post",dataType:"json",data:{folderName:a,nolink:b},beforeSend:function(){},success:function(a){$("#images_small").find(".images-preview").replaceWith(a.small);$("#images_medium").find(".images-preview").replaceWith(a.medium);$("#images_large").find(".images-preview").replaceWith(a.large);
$("#images_original").find(".images-preview").replaceWith(a.original);$("#files").hasClass("ui-state-active")&&$("#files").trigger("click").trigger("click");1>$(".ui-accordion-content-active").length&&$("#files").trigger("click")},error:function(){}})});$(document).on("click","#files",function(){var a=$("#list_files");$.ajax({url:$("#website_url").val()+"backend/backend_content/loadfiles",type:"post",dataType:"json",data:{folder:$("#adminselectimgfolder").val()},success:function(b){a.html(b.html)},
error:function(){a.html("Unable to load files list")}})});$("#widgets").click(function(){var a=$("#widgets_maker");a.html().length||$.ajax({url:$("#website_url").val()+"backend/backend_content/loadwidgetmaker",type:"post",dataType:"json",success:function(b){a.html(b.responseText)},error:function(){a.html('<h4 style="text-align: center;">Unable to load widget maker.</h4>')}})});var c=localStorage.getItem(generateStorageKey()),d=$(this).find("#content").val();null!==c&&c!=d&&showConfirm("We have found content that has not been saved! Restore?",
function(){tinymce.activeEditor.setContent(c);$("#content").val(c)},function(){localStorage.removeItem(generateStorageKey())},"success");$(document).on("click","span.refresh-items",function(a){a.preventDefault();$("#adminselectimgfolder").trigger("change")})});function dispatchEditorKeyup(c,d,a){var b=a;null===b&&(b=setTimeout(function(){localStorage.setItem(generateStorageKey(),tinymce.activeEditor.getContent());b=null},1E3))}
function insertFileLink(c,d){var a="";"undefined"!==typeof d&&(a=d);tinymce.activeEditor.execCommand("mceInsertContent",!1,'<a href="'+$("#website_url").val()+"media/"+$("#adminselectimgfolder").val()+"/"+c+'" title="'+a+'">'+c+"</a>")};
